(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{74:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return r})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return p}));var n=a(1),b=a(6),o=(a(0),a(97)),r={id:"getting_started_on_web",title:"Getting Started on web",sidebar_label:"Web"},i={unversionedId:"getting_started_on_web",id:"getting_started_on_web",isDocsHomePage:!1,title:"Getting Started on web",description:"Try the Demo",source:"@site/../docs/getting_started_on_web.md",slug:"/getting_started_on_web",permalink:"/fbt/docs/getting_started_on_web",version:"current",lastUpdatedBy:"David",lastUpdatedAt:1634169990,sidebar_label:"Web",sidebar:"docs",next:{title:"Getting Started with React Native",permalink:"/fbt/docs/getting_started_react_native"}},l=[{value:"Try the Demo",id:"try-the-demo",children:[]},{value:"NPM module dependencies",id:"npm-module-dependencies",children:[{value:"Babel Plugin ordering (Caveat)",id:"babel-plugin-ordering-caveat",children:[]},{value:"Webpack Example",id:"webpack-example",children:[]}]},{value:"Build-time / offline processes",id:"build-time--offline-processes",children:[{value:"Collection",id:"collection",children:[]},{value:"Translation",id:"translation",children:[]},{value:"How to use these scripts",id:"how-to-use-these-scripts",children:[]}]},{value:"Runtime",id:"runtime",children:[{value:"Initialization",id:"initialization",children:[]},{value:"Changing of translation locale on the fly",id:"changing-of-translation-locale-on-the-fly",children:[]}]}],c={rightToc:l};function p(e){var t=e.components,a=Object(b.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"try-the-demo"},"Try the Demo"),Object(o.b)("p",null,"Check out our ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt"}),"Github")," repository and run the Webpack demo app.\nSee ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/tree/main/demo-app#building-and-starting-the-demo-app"}),'"Building and starting the demo app"')),Object(o.b)("h1",{id:"integrating-into-your-app"},"Integrating into your app"),Object(o.b)("h2",{id:"npm-module-dependencies"},"NPM module dependencies"),Object(o.b)("p",null,"The required NPM modules to add to your ",Object(o.b)("inlineCode",{parentName:"p"},"dependencies")," in your app are:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/fbt"}),Object(o.b)("strong",{parentName:"a"},"fbt"))," - The ",Object(o.b)("inlineCode",{parentName:"li"},"fbt")," runtime module"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/babel-plugin-fbt"}),Object(o.b)("strong",{parentName:"a"},"babel-plugin-fbt"))," - The primary Babel transform"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/babel-plugin-fbt-runtime"}),Object(o.b)("strong",{parentName:"a"},"babel-plugin-fbt-runtime"))," - The secondary Babel transform",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Transforms the raw payloads within ",Object(o.b)("inlineCode",{parentName:"li"},"fbt._(...)")," so they can be used at runtime (by ",Object(o.b)("inlineCode",{parentName:"li"},"fbt._"),")"),Object(o.b)("li",{parentName:"ul"},"NOTE: ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/issues/125"}),"This plugin should get merged into ",Object(o.b)("inlineCode",{parentName:"a"},"babel-plugin-fbt"))))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/@fbtjs/default-collection-transform"}),Object(o.b)("strong",{parentName:"a"},"@fbtjs/default-collection-transform")),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Only required if if you elect ",Object(o.b)("em",{parentName:"li"},"not")," to pass a custom ",Object(o.b)("inlineCode",{parentName:"li"},"--transform")," nor ",Object(o.b)("inlineCode",{parentName:"li"},"--custom-collector")," in the ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/3fc75eb5b3303db6041df098b5f77a94b5f36309/packages/babel-plugin-fbt/src/bin/collectFbt.js#L116-L152"}),"collection script"))))),Object(o.b)("p",null,"If you're unfamiliar with ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://babeljs.io/"}),"Babel"),", you can read through ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://babeljs.io/"}),"their documentation here")),Object(o.b)("h3",{id:"babel-plugin-ordering-caveat"},"Babel Plugin ordering (Caveat)"),Object(o.b)("p",null,"There is a plugin ordering gotcha to be aware of if you use other Babel plugins.\nFBT expects to be the first plugin to visit its relevant ",Object(o.b)("inlineCode",{parentName:"p"},"<fbt>")," and ",Object(o.b)("inlineCode",{parentName:"p"},"fbt(...)")," nodes\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/issues/40"}),"See this Github issue tracking this")),Object(o.b)("p",null,"You'll hit issues if another transforms beats the ",Object(o.b)("inlineCode",{parentName:"p"},"babel-plugin-fbt"),'\nto the Babel AST, node and transforms it such that the plugin doesn\'t\n"recognize" as an ',Object(o.b)("inlineCode",{parentName:"p"},"fbt")," node anymore.  This is most commonly on JSX nodes.\nTo work around this you can use Babel's ",Object(o.b)("inlineCode",{parentName:"p"},"passPerPreset")," option, and ensure ",Object(o.b)("inlineCode",{parentName:"p"},"babel-plugin-fbt")," is in an earlier preset bundle:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"  babel.transformSync(source, {\n    passPerPreset: true,\n    {presets: [\n      {plugins: [\u2018babel-plugin-fbt\u2019, \u2018babel-plugin-fbt-runtime'...]}\n      {plugins: [\u2018babel-plugin-jsx-foo\u2019, ...]} //\n    ]},\n    ... // your other options\n  })\n")),Object(o.b)("h3",{id:"webpack-example"},"Webpack Example"),Object(o.b)("p",null,"You'll need to add the fbt babel transforms in a manner similar to our demo-app.\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/543e0a9c5b5c74e2094da3b94e3828c1dccacb7a/demo-app/webpack.config.js#L54-L59"}),"See our demo-app's Webpack config")),Object(o.b)("h2",{id:"build-time--offline-processes"},"Build-time / offline processes"),Object(o.b)("h3",{id:"collection"},"Collection"),Object(o.b)("p",null,"There are scripts bundled into the ",Object(o.b)("inlineCode",{parentName:"p"},"babel-plugin-fbt")," package that are designed for collecting source text (and associated metadata) from your application's source.\nThese are:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/19531133625dab1d38995dcf578dcfdfa0b09048/packages/babel-plugin-fbt/package.json#L10"}),"fbt-manifest")," -\nScans provided filesystem paths and generates a manifest of the ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://facebook.github.io/fbt/docs/enums"}),"enumeration modules"),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"NOTE"),": Enum modules must end in ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/3a5441708ca6b71c2c18fe5a952d1058a22306d1/packages/babel-plugin-fbt/bin/manifest.js#L66"}),"$FbtEnum.(js|jsx|ts|tsx)")," (i.e. ",Object(o.b)("inlineCode",{parentName:"li"},"Foo$FbtEnum.js"),")"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/19531133625dab1d38995dcf578dcfdfa0b09048/packages/babel-plugin-fbt/package.json#L9"}),"fbt-collectFbt")," -\nGiven source input, extract any source text and print them to STDOUT as JSON",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/@fbtjs/default-collection-transform"}),Object(o.b)("strong",{parentName:"a"},"@fbtjs/default-collection-transform"))," - As mentioned, this optional package provides a default transform for collection")))),Object(o.b)("h3",{id:"translation"},"Translation"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/19531133625dab1d38995dcf578dcfdfa0b09048/packages/babel-plugin-fbt/package.json#L11"}),"fbt-translate")," -\nCreates translation payloads for runtime",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Takes extracted source text (from ",Object(o.b)("inlineCode",{parentName:"li"},"collectFbt"),") and ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://facebook.github.io/fbt/docs/translating"}),"translations provided in JSON format")," to produce these payloads")))),Object(o.b)("h3",{id:"how-to-use-these-scripts"},"How to use these scripts"),Object(o.b)("p",null,"You can see how the demo-app ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/3a5441708ca6b71c2c18fe5a952d1058a22306d1/demo-app/package.json#L11-L14"}),"calls into these scripts here"),"."),Object(o.b)("p",null,"The demo app ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/3a5441708ca6b71c2c18fe5a952d1058a22306d1/demo-app/run_all.js"}),"runs all these in another script, here")),Object(o.b)("h2",{id:"runtime"},"Runtime"),Object(o.b)("p",null,"The ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.npmjs.com/package/fbt"}),"fbt runtime")," is what resolves the translation payload table generated during the translation phase into a singular result base on all the input provided at runtime."),Object(o.b)("h3",{id:"initialization"},"Initialization"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"fbt")," runtime requires that you initialize with your relevant translations via the ",Object(o.b)("inlineCode",{parentName:"p"},"init()")," function.  You can see an ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/df2414ab3eb00a94b4a082d8f62e0e39e3053e40/demo-app/src/example/Example.react.js#L22-L27"}),"example of this in the demo-app"),"."),Object(o.b)("h3",{id:"changing-of-translation-locale-on-the-fly"},"Changing of translation locale on the fly"),Object(o.b)("p",null,"Let's assume you've split your translation payloads per locale using the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/98d0516290975f614737387748769e235bf61216/packages/babel-plugin-fbt/bin/translate.js#L145-L153"}),Object(o.b)("inlineCode",{parentName:"a"},"--output-dir")," option")," of the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/facebook/fbt/blob/main/packages/babel-plugin-fbt/src/bin/translate.js"}),Object(o.b)("inlineCode",{parentName:"a"},"translate")," script"),". In this example, your app was initialized with the ",Object(o.b)("inlineCode",{parentName:"p"},"es_ES")," translation payload and, upon user request, you need to load ",Object(o.b)("inlineCode",{parentName:"p"},"fr_FR")," translations and show these in the UI. (We'll assume that your app already has access to the new translation payload)"),Object(o.b)("p",null,"In order to change of translation locale on the fly, you'll need to do all the items below:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Update the translation payload")," by calling ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/f58d7c24e675c925d6d54dc33aa749b1640da200/runtime/nonfb/FbtTranslations.js#L49"}),Object(o.b)("inlineCode",{parentName:"a"},"FbtTranslations.registerTranslations(newTranslationPayload)")),". The translation payload object used there should have the same structure as what was passed to the ",Object(o.b)("inlineCode",{parentName:"li"},"init()")," function."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Expose the current UI translation locale")," by providing a ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/df2414ab3eb00a94b4a082d8f62e0e39e3053e40/runtime/shared/FbtHooks.js#L83"}),Object(o.b)("inlineCode",{parentName:"a"},"getViewerContext()"))," hook to the ",Object(o.b)("inlineCode",{parentName:"li"},"init()")," function. See our our ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/facebook/fbt/blob/df2414ab3eb00a94b4a082d8f62e0e39e3053e40/demo-app/src/example/Example.react.js#L17-L27"}),"demo app")," for example.",Object(o.b)("ol",{parentName:"li"},Object(o.b)("li",{parentName:"ol"},"NOTE: it's not sufficient to only change the translation payload because we apply various number variation and phonological rules based on the UI locale. I.e. If you forget to change of locale, you might still end up displaying incorrect translations.")))))}p.isMDXComponent=!0},97:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return m}));var n=a(0),b=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,b=function(e,t){if(null==e)return{};var a,n,b={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(b[a]=e[a]);return b}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(b[a]=e[a])}return b}var c=b.a.createContext({}),p=function(e){var t=b.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=p(e.components);return b.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return b.a.createElement(b.a.Fragment,{},t)}},d=b.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,r=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),s=p(a),d=n,m=s["".concat(r,".").concat(d)]||s[d]||u[d]||o;return a?b.a.createElement(m,i(i({ref:t},c),{},{components:a})):b.a.createElement(m,i({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,r=new Array(o);r[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,r[1]=i;for(var c=2;c<o;c++)r[c]=a[c];return b.a.createElement.apply(null,r)}return b.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);